knitr::opts_chunk$set(echo = TRUE)
library(fpp2)
autoplot(uschange[,1:2], facets = TRUE) +
xlab("Year") + ylab("") +
ggtitle("Quarterly changes in US consumption
and personal income")
fit = auto.arima(uschange[,"Consumption"],
xreg = uschange[,"Income"])
summary(fit)
cbind("Regression Errors" = residuals(fit, type = "regression"),
"ARIMA Errors" = residuals(fit, type = "innovation")) %>%
autoplot(facets = TRUE)
checkresiduals(fit)
fcast = forecast(fit, xreg = rep(mean(uschange[,"Income"]),8))
autoplot(fcast) + xlab("Year") +
ylab("Percentage change")
qplot(Temperature, Demand, data = as.data.frame(elecdaily)) +
xlab("Temperature") + ylab("Demand")
autoplot(elecdaily[,c(1,3)], facets = TRUE, )
xreg = cbind(MaxTemp = elecdaily[,"Temperature"],
MaxTempsq = elecdaily[,"Temperature"]^2,
Workday = elecdaily[,"WorkDay"])
fit = auto.arima(elecdaily[,"Demand"], xreg = xreg)
summary(fit)
checkresiduals(fit)
fcast = forecast(fit, xreg = cbind(rep(26,14),
rep(26^2,14),
c(0,1,0,0,1,1,1,1,1,0,0,1,1,1)))
autoplot(fcast) + ylab("Electricity demand (GW)")
autoplot(austa) + xlab("Year") +
ylab("millions of people") +
ggtitle("Total annual international visitors in Australia")
trend = seq_along(austa)
(fit1 = auto.arima(austa, d = 0, xreg = trend))
(fit2 = auto.arima(austa, d = 1))
fc1 = forecast(fit1,
xreg = cbind(trend = length(austa) + 1:10))
fc2 = forecast(fit2, h = 10)
autoplot(austa) +
autolayer(fc2, "Stochastic trend") +
autolayer(fc1, "Deterministic trend") +
ggtitle("Forecasts from trend models") +
xlab("Year") + ylab("Visitors to Australia (millions)") +
guides(colour = guide_legend(title = "Forecast"))
?advert
head(advert)
autoplot(advert, facets = TRUE) +
xlab("Year")
autoplot(advert, facets = TRUE) +
xlab("Year") + ylab("")
autoplot(advert, facets = TRUE) +
xlab("Year") + ylab("Sales and advertising expenditure")
fit_linear = tslm(sales ~ advert, data = advert)
summary(fit_linear)
checkresiduals(fit_linear)
Arima(advert[,"sales"], xreg = advert[,"advert"],
order = c(0,0,0))
fit_arima = Arima(advert[,"sales"], xreg = advert[,"advert"],
order = c(0,0,0))
checkresiduals(fit_arima)
(fit_arima2 = auto.arima(advert[,"sales"], xreg = advert["advert"]))
(fit_arima2 = auto.arima(advert[,"sales"], xreg = advert[,"advert"]))
(fit_arima2 = auto.arima(advert[,"sales"], xreg = advert[,"advert"]))
checkresiduals(fit_arima2)
fc = forecast(fit_arima2, h = 6, xreg = rep(10,6))
autoplot(fc)
?huron
autoplot(huron)
1920 - min(huron)
time(huron)
time(huron)[1]
1920 - time(huron)[1]
trend = seq_along(huron)
trend_knot = max(0,trend - (1920 - min(huron)))
trend = seq_along(huron)
trend_knot = trend - (1920 - min(huron))
max(0,trend_knot)
sapply(trend_knot, max(0))
sapply(trend_knot, max)
max(trend_knot,rep(0, length(huron)))
trend = seq_along(huron)
trend_knot = trend - (1920 - min(time(huron)))
?rowMax
??rowMax
installpackages("Rfast")
install.packages("Rfast")
library(Rfast)
trend = seq_along(huron)
trend_knot = rowMaxs(trend - (1920 - min(time(huron))))
trend = seq_along(huron)
trend_knot = rowMaxs(0,trend - (1920 - min(time(huron))))
trend = seq_along(huron)
trend_knot = rowMaxs(cbind(seq(0, length(huron)),trend - (1920 - min(time(huron))))
cbind(seq(0, length(huron)),trend - (1920 - min(time(huron))))
cbind(rep(0, length(huron)),trend - (1920 - min(time(huron))))
rowMaxs(cbind(rep(0, length(huron)),trend - (1920 - min(time(huron)))))
?rowMax
??rowMax
apply(cbind(rep(0, length(huron)),trend - (1920 - min(time(huron))), 1, max)
)
apply(cbind(rep(0, length(huron)),trend - (1920 - min(time(huron)))), 1, max)
trend = seq_along(huron)
trend_knot = apply(cbind(rep(0, length(huron)),trend - (1920 - min(time(huron)))), 1, max)
trend = time(huron)
trend_knot = ts(pmax(0, trend - 1920), start = time(huron)[1])
trend = time(huron)
trend_knot = ts(pmax(0, trend - 1920), start = time(huron)[1])
fit.pw = tslm(huron ~ trend + trend_knot)
trend = time(huron)
trend_knot = ts(pmax(0, trend - 1920), start = time(huron)[1])
(fit.pw = tslm(huron ~ trend + trend_knot))
trend = time(huron)
trend_knot = ts(pmax(0, trend - 1920), start = time(huron)[1])
(fit.pw = auto.arima(huron, xreg = cbind(trend, trend_knot))
trend = time(huron)
trend_knot = ts(pmax(0, trend - 1920), start = time(huron)[1])
(fit.pw = auto.arima(huron, xreg = cbind(trend, trend_knot)))
autoplot(huron) +
autolayer(fit.pw$fitted)
t.fc = trend[length(trend)] + seq(30)
t.knot.fc = trend_knot[length(trend)] + seq(30)
fc = forecast(fit.pw, cbind(t.fc, t.knot.fc))
t.fc = trend[length(trend)] + seq(30)
t.knot.fc = trend_knot[length(trend)] + seq(30)
fc = forecast(fit.pw, xreg = cbind(t.fc, t.knot.fc), h = 30)
t.fc = trend[length(trend)] + seq(30)
t.knot.fc = trend_knot[length(trend)] + seq(30)
fc = forecast(fit.pw, xreg = cbind(t.fc, t.knot.fc), h = 30)
autoplot(fc)
?motel
autoplot(motel)
autoplot(motel, facets = TRUE)
mean(motel$Roomnights, motel$Takings)
mean(motel[,"Roomnights"], motel[,"Takings"])
autoplot(motel, facets = TRUE)
avg.cost = motel[,"Takings"] / motel[,"Roomnights"]
avg.cost = motel[,"Takings"] / motel[,"Roomnights"]
autoplot(avg.cost)
avg.cost = motel[,"Takings"] / motel[,"Roomnights"]
autoplot(avg.cost) +
xlab("Year") + ylab("Average accomodation cost")
avg.cost = motel[,"Takings"] / motel[,"Roomnights"]
autoplot(avg.cost) +
xlab("Year") + ylab("Average Accomodation Cost")
?cpimel
cpi_fit = auto.arima(cpimel,lambda = 0)
(cpi_fit = auto.arima(cpimel,lambda = 0))
autoplot(cpimel) +
autolayer(cpi_fit)
autoplot(cpimel) +
autolayer(cpi_fit$fitted)
autoplot(cpimel) +
autolayer(cpi_fit$fitted,series = "")
autoplot(cpimel) +
autolayer(cpi_fit$fitted,series = "Fitted Value")
